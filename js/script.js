const translations = {
    en: {
        home: "Home",
        videos: "Videos",
        about: "About",
        contact: "Contact Us",
        homeTitle: "Home",
        homeDescription: "Welcome to our collection of training videos. Our goal is to provide high-quality, field-ready resources for partners.",
        english: "English",
        french: "French",
        portuguese: "Portuguese",
        aboutTitle: "About",
        aboutDescription: "JF ADC is dedicated to equipping partners with tools, knowledge, and resources essential for success in the field.",
        contactTitle: "Contact",
        contactDescription: "Feel free to reach out to us at jfpadc@lmkenya.org for any inquiries or feedback.",
        projectorSetup: "Projector Set-up",
        projectorSetupDesc: "Learn how to set up the projector for optimal use in the field.",
        batteryCharging: "Projector Battery Charging Alternatives",
        wifiBoxGuide: "WiFi Box Quick Guide",
        wifiBoxGuideDesc: "A quick guide to setting up and using the WiFi Box.",
        audioBibleGuide: "AudioBible Quick Guide",
        audioBibleGuideDesc: "Instructions for using the AudioBible effectively.",
        tabletGuide: "Tablet Quick Guide",
        tabletGuideDesc: "Step-by-step guide to using the tablet for training purposes.",
        screenSetup: "Projector Screen Setup",
        screenSetupDesc: "Tips and tricks for setting up the projector screen.",
        electricityCharging: "Charging via Electricity",
        solarCharging: "Charging via Solar",
        automobileAuxiliaryCharging: "Charging via Automobile Auxiliary Power Outlet",
        motorcycleBatteryCharging: "Charging via Motorcycle Battery",
        carBatteryCharging: "Charging via Car Battery",
        purposeTitle: "Purpose of the Site",
        purposeDescription: "Welcome to our collection of JF equipment training videos. Our goal is to provide high-quality, field-ready resources for partners.",
        centerTitle: "JF Africa Distribution Center",
        centerSubtitle: "Ensuring Partners are Well Equipped for the Field",
        watabaScreen: "Wataba Projector Screen",
        watabaScreenDesc: "Learn how to set up and use the Wataba projector screen.",
        renewWorldScreen: "Renew World Screen",
        renewWorldScreenDesc: "Learn how to set up and use the Renew World projector screen.",
        "50viewer": "50-Viewer Set Projector",
        "vista200": "Vista 200 Set",
        "eprojector": "E-Projector",
        "renewWorldCarousel": "Renew World Outreach Tutorials",
        "renewWorldCarouselTitle": "Renew World Outreach Tutorials",
        "tutorial1": "Vista 200 Bright: Quick Start",
        "tutorial2": "50 Viewer Set: Quick Start",
        "tutorial3": "E Vista: Quick Start",
    },
    fr: {
        home: "Accueil",
        videos: "Vidéos",
        about: "À propos",
        contact: "Contactez-nous",
        homeTitle: "Accueil",
        homeDescription: "Bienvenue dans notre collection de vidéos de formation. Notre objectif est de fournir des ressources de haute qualité et prêtes à l'emploi pour nos partenaires.",
        english: "Anglais",
        french: "Français",
        portuguese: "Portugais",
        aboutTitle: "À propos",
        aboutDescription: "JF ADC se consacre à fournir aux partenaires les outils, les connaissances et les ressources essentiels à leur succès sur le terrain.",
        contactTitle: "Contact",
        contactDescription: "N'hésitez pas à nous contacter à jfpadc@lmkenya.org pour toute question ou commentaire.",
        projectorSetup: "Configuration du projecteur",
        projectorSetupDesc: "Apprenez à configurer le projecteur pour une utilisation optimale sur le terrain.",
        batteryCharging: "Alternatives de chargement de la batterie du projecteur",
        wifiBoxGuide: "Guide rapide du boîtier WiFi",
        wifiBoxGuideDesc: "Un guide rapide pour configurer et utiliser le boîtier WiFi.",
        audioBibleGuide: "Guide rapide de l'AudioBible",
        audioBibleGuideDesc: "Instructions pour utiliser efficacement l'AudioBible.",
        tabletGuide: "Guide rapide de la tablette",
        tabletGuideDesc: "Guide étape par étape pour utiliser la tablette à des fins de formation.",
        screenSetup: "Configuration de l'écran du projecteur",
        screenSetupDesc: "Conseils et astuces pour configurer l'écran du projecteur.",
        electricityCharging: "Chargement via l'électricité",
        solarCharging: "Chargement via l'énergie solaire",
        automobileAuxiliaryCharging: "Chargement via la prise auxiliaire de l'automobile",
        motorcycleBatteryCharging: "Chargement via la batterie de la moto",
        carBatteryCharging: "Chargement via la batterie de la voiture",
        purposeTitle: "Objectif du site",
        purposeDescription: "Bienvenue dans notre collection de vidéos de formation sur l'équipement JF. Notre objectif est de fournir des ressources de haute qualité et prêtes à l'emploi pour les partenaires.",
        centerTitle: "Centre de Distribution JF Afrique",
        centerSubtitle: "Assurer que les partenaires sont bien équipés pour le terrain",
        watabaScreen: "Écran de Projecteur Wataba",
        watabaScreenDesc: "Apprenez à installer et à utiliser l'écran de projecteur Wataba.",
        renewWorldScreen: "Écran Renew World",
        renewWorldScreenDesc: "Apprenez à installer et à utiliser l'écran de projecteur Renew World.",
        "50viewer": "Projecteur Set 50-Viewer",
        "vista200": "Set Vista 200",
        "eprojector": "E-Projecteur",
        "renewWorldCarousel": "Tutoriels Renew World Outreach",
        "renewWorldCarouselTitle": "Tutoriels Renew World Outreach",
        "tutorial1": "Vista 200 Bright : Démarrage rapide",
        "tutorial2": "Set 50 Viewer : Démarrage rapide",
        "tutorial3": "E Vista : Démarrage rapide",
    },
    pt: {
        home: "Início",
        videos: "Vídeos",
        about: "Sobre",
        contact: "Contate-nos",
        homeTitle: "Início",
        homeDescription: "Bem-vindo à nossa coleção de vídeos de treinamento. Nosso objetivo é fornecer recursos de alta qualidade e prontos para uso em campo para nossos parceiros.",
        english: "Inglês",
        french: "Francês",
        portuguese: "Português",
        aboutTitle: "Sobre",
        aboutDescription: "A JF ADC se dedica a equipar os parceiros com as ferramentas, o conhecimento e os recursos essenciais para o sucesso em campo.",
        contactTitle: "Contato",
        contactDescription: "Sinta-se à vontade para entrar em contato conosco em jfpadc@lmkenya.org para quaisquer perguntas ou comentários.",
        projectorSetup: "Configuração do projetor",
        projectorSetupDesc: "Aprenda como configurar o projetor para uso ideal em campo.",
        batteryCharging: "Alternativas de carregamento da bateria do projetor",
        wifiBoxGuide: "Guia rápido da caixa WiFi",
        wifiBoxGuideDesc: "Um guia rápido para configurar e usar a caixa WiFi.",
        audioBibleGuide: "Guia rápido do AudioBible",
        audioBibleGuideDesc: "Instruções para usar o AudioBible de forma eficaz.",
        tabletGuide: "Guia rápido do tablet",
        tabletGuideDesc: "Guia passo a passo para usar o tablet para fins de treinamento.",
        screenSetup: "Configuração da tela do projetor",
        screenSetupDesc: "Dicas e truques para configurar a tela do projetor.",
        electricityCharging: "Carregamento via eletricidade",
        solarCharging: "Carregamento via energia solar",
        automobileAuxiliaryCharging: "Carregamento através da tomada auxiliar do automóvel",
        motorcycleBatteryCharging: "Carregamento através da bateria da motocicleta",
        carBatteryCharging: "Carregamento através da bateria do carro",
        purposeTitle: "Objetivo do Site",
        purposeDescription: "Bem-vindo à nossa coleção de vídeos de treinamento de equipamentos JF. Nosso objetivo é fornecer recursos de alta qualidade e prontos para uso em campo para nossos parceiros.",
        centerTitle: "Centro de Distribuição JF África",
        centerSubtitle: "Garantindo que os parceiros estejam bem equipados para o campo",
        watabaScreen: "Tela de Projetor Wataba",
        watabaScreenDesc: "Aprenda a configurar e usar a tela de projetor Wataba.",
        renewWorldScreen: "Tela Renew World",
        renewWorldScreenDesc: "Aprenda a configurar e usar a tela de projetor Renew World.",
        "50viewer": "Projetor Set 50-Viewer",
        "vista200": "Set Vista 200",
        "eprojector": "E-Projetor",
        "renewWorldCarousel": "Tutoriais Renew World Outreach",
        "renewWorldCarouselTitle": "Tutoriais Renew World Outreach",
        "tutorial1": "Vista 200 Bright: Início Rápido",
        "tutorial2": "Set 50 Viewer: Início Rápido",
        "tutorial3": "E Vista: Início Rápido",
    }
};

let currentLanguage = 'en'; // Default language

function translatePage(lang) {
    // Translate all elements with data-i18n
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    // Translate all equipment and alternative buttons
    document.querySelectorAll('.equipment-button, .alternative-button').forEach(btn => {
        const key = btn.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            btn.textContent = translations[lang][key];
        }
    });
}

// Example: Add event listeners for language links
document.querySelectorAll('.language-links a').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        const lang = this.getAttribute('data-lang');
        translatePage(lang);
    });
});

function getVideoUrl(equipment, alternative) {
    switch (equipment) {
        case 'projector':
            switch (alternative) {
                case '50viewer':
                    return 'https://www.youtube.com/embed/YOUR_50VIEWER_VIDEO_ID';
                case 'vista200':
                    return 'https://www.youtube.com/embed/SfA9vJ_Ilik'; // <-- Use your previous Projector Set-up YouTube embed here
                case 'eprojector':
                    return 'https://www.youtube.com/embed/YOUR_EPROJECTOR_VIDEO_ID';
                default:
                    return '';
            }
        case 'battery':
            switch (alternative) {
                case 'electricity':
                    return 'https://www.youtube.com/embed/2T_Cd_B4Vdo';
                case 'solar':
                    return 'https://www.youtube.com/embed/YOUR_BATTERY_SOLAR_VIDEO_ID';
                case 'automobileAuxiliary':
                    return 'https://www.youtube.com/embed/YOUR_BATTERY_CAR_CIGARETTE_VIDEO_ID';
                case 'motorcycleBattery':
                    return 'https://www.youtube.com/embed/XUpQpR0QjyU';
                case 'carBattery':
                    return 'https://www.youtube.com/embed/o0Qa8p02ddQ';
                default:
                    return '';
            }
        case 'wifi':
            return 'https://www.youtube.com/embed/SfA9vJ_Ilik';
        case 'audiobible':
            return 'https://www.youtube.com/embed/K5pTdR2cU5Q';
        case 'tablet':
            return 'https://www.youtube.com/embed/rn91OeTA8Rk';
        case 'screen':
            switch (alternative) {
                case 'watabaScreen':
                    return 'https://www.youtube.com/embed/9i0uvBHPCRg';
                case 'renewWorldScreen':
                    return 'https://www.youtube.com/embed/YOUR_RENEW_WORLD_SCREEN_VIDEO_ID';
                default:
                    return '';
            }
        default:
            return '';
    }
}

document.addEventListener('DOMContentLoaded', () => {
    // Hide all alternatives on page load
    document.getElementById("batteryAlternatives").style.display = "none";
    document.getElementById("screenAlternatives").style.display = "none";
    document.getElementById("projectorAlternatives").style.display = "none";

    // Language translation handling
    const langLinks = document.querySelectorAll('.language-links a');
    langLinks.forEach(link => {
        link.addEventListener('click', (event) => {
            event.preventDefault();
            const lang = link.dataset.lang;
            translatePage(lang);
            currentLanguage = lang; // Update current language
        });
    });

    // Modal elements
    const modal = document.getElementById("equipmentModal");
    const modalContent = modal.querySelector('.modal-content');
    const equipmentButtons = document.querySelectorAll(".equipment-button");
    const alternativeButtons = document.querySelectorAll(".alternative-button");
    const closeBtn = document.querySelector(".close");
    const modalTitle = document.getElementById("modalTitle");
    const modalDescription = document.getElementById("modalDescription");
    const modalVideo = document.getElementById("modalVideo");
    const batteryAlternatives = document.getElementById("batteryAlternatives");
    const screenAlternatives = document.getElementById("screenAlternatives");

    // Function to open modal with animation and content
    function openModal(equipment, i18nKey) {
        // Set the modal content
        modalTitle.textContent = translations[currentLanguage][i18nKey];
        modalDescription.textContent = translations[currentLanguage][i18nKey + 'Desc'] || '';
        modalVideo.src = getVideoUrl(equipment, i18nKey);
        
        // Show the modal with animation
        modal.classList.add('show');
        modalContent.style.opacity = 0;
        modalContent.style.transform = 'scale(0.8)';
        
        setTimeout(() => {
            modalContent.style.opacity = 1;
            modalContent.style.transform = 'scale(1)';
        }, 100);
    }

    // When the user clicks on an equipment button
    equipmentButtons.forEach(button => {
        button.addEventListener("click", function() {
            const equipment = this.dataset.equipment;

            // Hide all alternatives by default
            batteryAlternatives.style.display = "none";
            screenAlternatives.style.display = "none";
            document.getElementById("projectorAlternatives").style.display = "none";

            if (equipment === 'battery') {
                batteryAlternatives.style.display = "flex";
            } else if (equipment === 'screen') {
                screenAlternatives.style.display = "flex";
            } else if (equipment === 'projector') {
                // Only show projector alternatives, do NOT open modal
                document.getElementById("projectorAlternatives").style.display = "flex";
            } else {
                // For other equipment, open modal directly
                openModal(equipment, this.dataset.i18n);
            }
        });
    });

    // When the user clicks on a battery alternative button
    alternativeButtons.forEach(button => {
        button.addEventListener("click", function() {
            const alternative = this.dataset.alternative;
            const parentId = this.parentElement.id;
            
            if (parentId === "batteryAlternatives") {
                openModal('battery', alternative);
            } else if (parentId === "screenAlternatives") {
                openModal('screen', alternative);
            } else if (parentId === "projectorAlternatives") {
                if (alternative === "renewWorldCarousel") {
                    openCarouselModal();
                } else {
                    openModal('projector', alternative);
                }
            }
        });
    });

    // Close modal function
    function closeModal() {
        modalContent.style.opacity = 0;
        modalContent.style.transform = 'scale(0.8)';
        
        setTimeout(() => {
            modal.classList.remove('show');
            modalVideo.src = ""; // Stop video when closing modal
            batteryAlternatives.style.display = "none"; // Hide battery alternatives
            screenAlternatives.style.display = "none"; // Hide screen alternatives
        }, 400);
    }

    // When the user clicks on the close button
    closeBtn.addEventListener('click', closeModal);
    
    // When the user clicks anywhere outside of the modal
    window.addEventListener('click', function(event) {
        if (event.target === modal) {
            closeModal();
        }
    });
    
    // Initialize with English
    translatePage('en');

    // Add event listener for projector alternatives
    const projectorAlternatives = document.getElementById("projectorAlternatives");
    if (projectorAlternatives) {
        projectorAlternatives.querySelectorAll(".alternative-button").forEach(button => {
            button.addEventListener("click", function() {
                const alt = this.dataset.alternative;
                if (alt === "renewWorldCarousel") {
                    openCarouselModal();
                } else {
                    openModal('projector', alt);
                }
            });
        });
    }

    // Carousel logic
    const carouselVideos = [
        {
            key: "tutorial1",
            vimeo: "https://player.vimeo.com/video/182567575"
        },
        {
            key: "tutorial2",
            vimeo: "https://player.vimeo.com/video/xxxxxxxxx" // Replace with actual Vimeo link
        },
        {
            key: "tutorial3",
            vimeo: "https://player.vimeo.com/video/xxxxxxxxx" // Replace with actual Vimeo link
        }
    ];

    function openCarouselModal() {
        const modal = document.getElementById("carouselModal");
        const carouselInner = modal.querySelector(".carousel-inner");
        const carouselTitle = modal.querySelector("#carouselTitle");
        carouselTitle.textContent = translations[currentLanguage]["renewWorldCarouselTitle"];
        carouselInner.innerHTML = "";
        carouselVideos.forEach((vid, idx) => {
            const slide = document.createElement("div");
            slide.className = "carousel-slide" + (idx === 0 ? " active" : "");
            slide.innerHTML = `<div class="carousel-title">${translations[currentLanguage][vid.key]}</div>
                <iframe src="${vid.vimeo}" width="560" height="315" frameborder="0" allowfullscreen></iframe>`;
            carouselInner.appendChild(slide);
        });
        modal.classList.add("show");
        setupCarouselControls(modal, carouselVideos.length);
    }

    function setupCarouselControls(modal, total) {
        let current = 0;
        const slides = modal.querySelectorAll(".carousel-slide");
        const prevBtn = modal.querySelector(".carousel-control.prev");
        const nextBtn = modal.querySelector(".carousel-control.next");
        function show(idx) {
            slides.forEach((s, i) => s.classList.toggle("active", i === idx));
        }
        prevBtn.onclick = () => { current = (current - 1 + total) % total; show(current); };
        nextBtn.onclick = () => { current = (current + 1) % total; show(current); };
        // Close modal on X
        modal.querySelector(".close").onclick = () => { modal.classList.remove("show"); };
        // Optional: close on background click
        modal.onclick = e => { if (e.target === modal) modal.classList.remove("show"); };
    }
});